<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="dark">
    <meta name="theme-color" content="#0a0a0c">
    <title>数字孪生古建筑火灾监控系统</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <div id="app">
        <!-- 顶部状态栏 -->
        <header-bar
            :system-status="systemStatus"
            :buildings="buildings"
            :current-building="currentBuilding"
            :floors="floors"
            :current-floor="currentFloor"
            @building-change="handleBuildingChange"
            @floor-change="switchFloor"
        ></header-bar>
        
        <!-- 主内容区 -->
        <div class="main-container">
            <!-- 左侧栏 -->
            <sidebar-left
                :cameras="cameras"
                :sensors="sensors"
                @camera-click="openVideoModal"
            ></sidebar-left>
            
            <!-- 中央平面图区域 -->
            <floor-plan-canvas
                :floor-plan="floorPlan"
                :facilities="facilities"
                :cameras="cameras"
                :sensors="sensors"
                @facility-click="handleFacilityClick"
            ></floor-plan-canvas>
            
            <!-- 右侧栏 -->
            <sidebar-right
                :alerts="alerts"
                @alert-click="handleAlertClick"
            ></sidebar-right>
        </div>
        
        <!-- 底部统计栏 -->
        <footer-stats
            :system-status="systemStatus"
            :cameras="cameras"
        ></footer-stats>
        
        <!-- 视频弹窗 -->
        <video-modal
            v-if="showVideoModal"
            :camera="selectedCamera"
            @close="closeVideoModal"
        ></video-modal>
        
        <!-- 传感器详情弹窗 -->
        <sensor-modal
            v-if="showSensorModal"
            :sensor="selectedSensor"
            :facility="selectedFacility"
            @close="closeSensorModal"
        ></sensor-modal>
        
        <!-- 加载遮罩 -->
        <div v-if="loading" class="loading-overlay">
            <div class="loading-spinner">
                <div class="spinner"></div>
                <div class="loading-text">系统初始化中...</div>
            </div>
        </div>
    </div>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3.4.15/dist/vue.global.js"></script>
    
    <!-- Socket.IO客户端 -->
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    
    <!-- 主应用脚本（必须先加载以创建app实例） -->
    <script src="/static/js/app.js"></script>
    
    <!-- Vue组件（在app创建后加载） -->
    <script src="/static/js/components/HeaderBar.js"></script>
    <script src="/static/js/components/SidebarLeft.js"></script>
    <script src="/static/js/components/SidebarRight.js"></script>
    <script src="/static/js/components/FooterStats.js"></script>
    <script src="/static/js/components/FloorPlanCanvas.js"></script>
    <script src="/static/js/components/VideoModal.js"></script>
    <script src="/static/js/components/SensorModal.js"></script>
    
    <!-- 挂载应用（在所有组件注册后） -->
    <script>
      // 挂载Vue应用
      app.mount('#app');
    </script>
</body>
</html>
